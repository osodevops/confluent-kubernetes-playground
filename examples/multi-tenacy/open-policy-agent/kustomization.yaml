apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: opa
resources:
  - namespace.yaml
  - sar-clusterrole.yaml
  - sar-clusterrolebinding.yaml
  - serviceaccount.yaml
  - service.yaml
  - webhookconfiguration.yaml
  - deployment.yaml

configMapGenerator:
- name: opa-default-system-main
  files:
    - policies/main.rego

generatorOptions:
  disableNameSuffixHash: true
  labels:
    openpolicyagent.org/policy: rego